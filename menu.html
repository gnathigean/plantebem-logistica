<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu Plantebem</title>
    
    <link rel="stylesheet" href="/menu.css"> 
</head>
<body>
    
    <div class="fixed-nav">
        <a href="menu.html" class="botao-menu">Menu</a>
        <button id="logout-button">Sair</button>
    </div>

    <div class="logo-container">
        <img src="https://contagem.plantebemtec.com.br/Logotipo%20com%20Simbolo%20padrao.png" alt="Logo da Empresa" class="logo-img">
    </div>

    <div class="menu-container">
        <div class="menu-header">Menu Principal</div>
        <ul class="menu-list">
            <li class="menu-list-item"><a href="menu.html">In√≠cio</a></li>
            <li class="menu-list-item"><a href="menu.html">Cat√°logo (EM PRODU√á√ÉO)</a></li>
            <li class="menu-list-item"><a href="menu.html">Mapa de Produtos (EM PRODU√á√ÉO)</a></li>
            
            
            <li class="menu-list-item" id="admin-cadastro-link" style="display: none;">
                <a href="/cadastro.html">CADASTRAR USUARIOS</a>
            </li>
        </ul>

        <div class="loja-selecao-container">
            <label for="seletor-loja">Recebimento de Mercadorias:</label>
            <select id="seletor-loja">
                <option value="">-- Selecione uma Loja --</option>
                <option value="petrolina" data-url="recebimento_petrolina.html">Matriz</option>
                <option value="juazeiro" data-url="recebimento_juazeiro.html">Filial Juazeiro</option>
                <option value="salvador" data-url="recebimento_loteamento.html">Filial Loteamento</option>
                <option value="salvador" data-url="recebimento_irece.html">Filial Irec√™</option>
                <option value="salvador" data-url="recebimento_rioreal.html">Filial Rio Real</option>
                <option value="salvador" data-url="recebimento_agroexpress.html">Agroexpress</option>
                <option value="salvador" data-url="recebimento_grandesafra.html">Grande Safra</option>
            </select>
        </div>

        <div id="botao-loja-container"></div>
    </div>
    
    <script type="module">
        // Importa as fun√ß√µes modulares necess√°rias do Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
        
        // ‚ö†Ô∏è 1. COLOQUE SUAS CONFIGURA√á√ïES FIREBASE AQUI ‚ö†Ô∏è
    const firebaseConfig = {
      apiKey: "AIzaSyD8GjaS3tuDpSvBl2-bpa-QXIKTqq80Mn4",
      authDomain: "login-com-dados.firebaseapp.com",
      projectId: "login-com-dados",
      storageBucket: "login-com-dados.firebasestorage.app",
      messagingSenderId: "75556023458",
      appId: "1:75556023458:web:9f1362d0597603c0f37bfb",
      measurementId: "G-W9LRT99579"
    };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        // üö® 2. COLOQUE SEU UID PESSOAL AQUI üö®
        const ADMIN_UID = "O02XwNu2KSNCCk0xCvdBE2YxW9G2"; 
        
        const logoutButton = document.getElementById("logout-button");
        const adminCadastroLink = document.getElementById("admin-cadastro-link");
        
        // --- L√ìGICA DE AUTENTICA√á√ÉO E CONTROLE DE VISIBILIDADE ---
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Usu√°rio logado
                logoutButton.style.display = 'inline-block';
                
                // Verifica o UID do usu√°rio
                if (user.uid === ADMIN_UID) {
                    // Se for o Admin, exibe o link de cadastro
                    adminCadastroLink.style.display = 'block'; 
                } else {
                    // Se n√£o for o Admin, mant√©m o link escondido
                    adminCadastroLink.style.display = 'none';
                }
            } else {
                // Ningu√©m logado: Redireciona para a p√°gina de login
                window.location.href = 'index.html'; 
            }
        });
        
        // FUNCIONALIDADE DO BOT√ÉO DE SAIR
        logoutButton.addEventListener('click', () => {
            signOut(auth).then(() => {
                window.location.href = 'index.html';
            }).catch((error) => {
                console.error("Erro ao deslogar:", error);
            });
        });

        // --- L√ìGICA DO SELETOR DE LOJA (MANTIDA) ---
        function exibirBotaoDaLoja() {
            const seletor = document.getElementById('seletor-loja');
            const container = document.getElementById('botao-loja-container');
            
            container.innerHTML = ''; 
            const valorSelecionado = seletor.value;

            if (valorSelecionado) {
                const opcaoSelecionada = seletor.options[seletor.selectedIndex];
                const urlDaLoja = opcaoSelecionada.getAttribute('data-url');
                const nomeDaLoja = opcaoSelecionada.textContent;

                const botao = document.createElement('a');
                botao.setAttribute('href', urlDaLoja);
                botao.setAttribute('class', 'btn-loja');
                botao.style.display = 'inline-block'; 
                botao.textContent = `Acessar ${nomeDaLoja}`;
                container.appendChild(botao);
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const seletor = document.getElementById('seletor-loja');
            seletor.addEventListener('change', exibirBotaoDaLoja); 
        });

    </script>
</body>
</html>